---
title: vue最佳实践
tags: []
toc: true
date: 2023-06-27 14:50:49
categories : Vue
---
#### 一、设置属性key 
**key属性主要用于虚拟dom的算法中，在对比新旧虚拟DOM时 辨识虚拟DOM，加快查找速度。**

使用场景：
1）v-for 渲染列表
2）v-if/v-if-else/v-else 元素类型相同时 （删除后新增 vs 就地修改）

#### 二、路由切换组件不变 
现象：
/detail/1  切换到 /detail/2时，组件的声明周期钩子不会重新触发

原因：
vue-router识别出两个路由是使用同一个组件，从而进行复用，并不会重新创建组件，因此生命周期钩子不会被触发

解决方案：
**（1）路由导航守卫beforeRouteUpdate （优）**
该守卫在当前路由改变且组件被复用时调用，所以可以在组件内定义路由导航守卫来解决这个问题

**（2）观察$route 对象的变化**
```js
watch:{
    '$route'(to,from){
        // 对路由变化作出响应
    }
}
```
缺点：组件内多一个watch，会带来依赖追踪的内存开销
如果最终选择使用watch 解决这个问题，推荐只观察自己需要的query,来减少不必要的请求

```js
watch:{
    '$route.query.id'(){

    }
}
```

**（3）为router-view 组件添加属性key** 
不推荐，设置key 每次切换路由都会先销毁组件再创建新组件，造成性能浪费。


#### [揭秘 Vue.js 九个性能优化技巧](https://juejin.cn/post/6922641008106668045)

